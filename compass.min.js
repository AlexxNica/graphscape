!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.cp=e()}}(function(){var e;return function n(e,t,r){function i(o,u){if(!t[o]){if(!e[o]){var c="function"==typeof require&&require;if(!u&&c)return c(o,!0);if(a)return a(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(n){var t=e[o][1][n];return i(t?t:n)},l,l.exports,n,e,t,r)}return t[o].exports}for(var a="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,n,t){},{}],2:[function(e,n,t){n.exports={hcluster:e("./hcluster"),Kmeans:e("./kmeans"),kmeans:e("./kmeans").kmeans}},{"./hcluster":4,"./kmeans":5}],3:[function(e,n,t){n.exports={euclidean:function(e,n){for(var t=0,r=0;r<e.length;r++)t+=Math.pow(n[r]-e[r],2);return Math.sqrt(t)},manhattan:function(e,n){for(var t=0,r=0;r<e.length;r++)t+=Math.abs(n[r]-e[r]);return t},max:function(e,n){for(var t=0,r=0;r<e.length;r++)t=Math.max(t,Math.abs(n[r]-e[r]));return t}}},{}],4:[function(e,n,t){var r=e("./distance"),i=function(e,n,t){this.distance=e,this.linkage=n,this.threshold=void 0==t?1/0:t};i.prototype={cluster:function(e,n,t){this.clusters=[],this.dists=[],this.mins=[],this.index=[];for(var r=0;r<e.length;r++){var i={value:e[r],key:r,index:r,size:1};this.clusters[r]=i,this.index[r]=i,this.dists[r]=[],this.mins[r]=0}for(var r=0;r<this.clusters.length;r++)for(var a=0;r>=a;a++){var o=r==a?1/0:this.distance(this.clusters[r].value,this.clusters[a].value);this.dists[r][a]=o,this.dists[a][r]=o,o<this.dists[r][this.mins[r]]&&(this.mins[r]=a)}for(var u=this.mergeClosest(),r=0;u;)t&&r++%n==0&&t(this.clusters),u=this.mergeClosest();return this.clusters.forEach(function(e){delete e.key,delete e.index}),this.clusters},mergeClosest:function(){for(var e=0,n=1/0,t=0;t<this.clusters.length;t++){var r=this.clusters[t].key,i=this.dists[r][this.mins[r]];n>i&&(e=r,n=i)}if(n>=this.threshold)return!1;var a=this.index[e],o=this.index[this.mins[e]],u={left:a,right:o,key:a.key,size:a.size+o.size};this.clusters[a.index]=u,this.clusters.splice(o.index,1),this.index[a.key]=u;for(var t=0;t<this.clusters.length;t++){var i,c=this.clusters[t];a.key==c.key?i=1/0:"single"==this.linkage?(i=this.dists[a.key][c.key],this.dists[a.key][c.key]>this.dists[o.key][c.key]&&(i=this.dists[o.key][c.key])):"complete"==this.linkage?(i=this.dists[a.key][c.key],this.dists[a.key][c.key]<this.dists[o.key][c.key]&&(i=this.dists[o.key][c.key])):i="average"==this.linkage?(this.dists[a.key][c.key]*a.size+this.dists[o.key][c.key]*o.size)/(a.size+o.size):this.distance(c.value,a.value),this.dists[a.key][c.key]=this.dists[c.key][a.key]=i}for(var t=0;t<this.clusters.length;t++){var s=this.clusters[t].key;if(this.mins[s]==a.key||this.mins[s]==o.key){for(var n=s,l=0;l<this.clusters.length;l++){var f=this.clusters[l].key;this.dists[s][f]<this.dists[s][n]&&(n=f)}this.mins[s]=n}this.clusters[t].index=t}return delete a.key,delete o.key,delete a.index,delete o.index,!0}};var a=function(e,n,t,a,o,u){n=n||"euclidean",t=t||"average","string"==typeof n&&(n=r[n]);var c=new i(n,t,a).cluster(e,o,u);return void 0===a?c[0]:c};n.exports=a},{"./distance":3}],5:[function(e,n,t){function r(e){this.centroids=e||[]}var i=e("./distance");r.prototype.randomCentroids=function(e,n){var t=e.slice(0);return t.sort(function(){return Math.round(Math.random())-.5}),t.slice(0,n)},r.prototype.classify=function(e,n){var t=1/0,r=0;n=n||"euclidean","string"==typeof n&&(n=i[n]);for(var a=0;a<this.centroids.length;a++){var o=n(e,this.centroids[a]);t>o&&(t=o,r=a)}return r},r.prototype.cluster=function(e,n,t,r,a){n=n||Math.max(2,Math.ceil(Math.sqrt(e.length/2))),t=t||"euclidean","string"==typeof t&&(t=i[t]),this.centroids=this.randomCentroids(e,n);for(var o=new Array(e.length),u=new Array(n),c=0,s=!0;s;){for(var l=0;l<e.length;l++)o[l]=this.classify(e[l],t);s=!1;for(var f=0;n>f;f++){for(var d=[],l=0;l<o.length;l++)o[l]==f&&d.push(e[l]);if(d.length){for(var E=this.centroids[f],O=new Array(E.length),g=0;g<E.length;g++){for(var T=0,l=0;l<d.length;l++)T+=d[l][g];O[g]=T/d.length,O[g]!=E[g]&&(s=!0)}this.centroids[f]=O,u[f]=d}}a&&c++%r==0&&a(u)}return u},r.prototype.toJSON=function(){return JSON.stringify(this.centroids)},r.prototype.fromJSON=function(e){return this.centroids=JSON.parse(e),this},n.exports=r,n.exports.kmeans=function(e,n){return(new r).cluster(e,n)}},{"./distance":3}],6:[function(n,t,r){!function(n,i){"object"==typeof r&&"undefined"!=typeof t?i(r):"function"==typeof e&&e.amd?e("d3-time",["exports"],i):i(n.d3_time={})}(this,function(e){"use strict";function n(e,t,r,o){function u(n){return e(n=new Date(+n)),n}return u.floor=u,u.round=function(n){var r=new Date(+n),i=new Date(n-1);return e(r),e(i),t(i,1),i-n>n-r?r:i},u.ceil=function(n){return e(n=new Date(n-1)),t(n,1),n},u.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},u.range=function(n,r,i){var a=[];if(n=new Date(n-1),r=new Date(+r),i=null==i?1:Math.floor(i),!(r>n&&i>0))return a;for(t(n,1),e(n),r>n&&a.push(new Date(+n));t(n,i),e(n),r>n;)a.push(new Date(+n));return a},u.filter=function(r){return n(function(n){for(;e(n),!r(n);)n.setTime(n-1)},function(e,n){for(;--n>=0;)for(;t(e,1),!r(e););})},r&&(u.count=function(n,t){return i.setTime(+n),a.setTime(+t),e(i),e(a),Math.floor(r(i,a))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(o?function(n){return o(n)%e===0}:function(n){return u.count(0,n)%e===0}):u:null}),u}function t(e){return n(function(n){n.setHours(0,0,0,0),n.setDate(n.getDate()-(n.getDay()+7-e)%7)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5})}function r(e){return n(function(n){n.setUTCHours(0,0,0,0),n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/6048e5})}var i=new Date,a=new Date,o=n(function(){},function(e,n){e.setTime(+e+n)},function(e,n){return n-e});o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?n(function(n){n.setTime(Math.floor(n/e)*e)},function(n,t){n.setTime(+n+t*e)},function(n,t){return(t-n)/e}):o:null};var u=n(function(e){e.setMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getSeconds()}),c=n(function(e){e.setSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getMinutes()}),s=n(function(e){e.setMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getHours()}),l=n(function(e){e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/864e5},function(e){return e.getDate()-1}),f=t(0),d=t(1),E=t(2),O=t(3),g=t(4),T=t(5),m=t(6),A=n(function(e){e.setHours(0,0,0,0),e.setDate(1)},function(e,n){e.setMonth(e.getMonth()+n)},function(e,n){return n.getMonth()-e.getMonth()+12*(n.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),_=n(function(e){e.setHours(0,0,0,0),e.setMonth(0,1)},function(e,n){e.setFullYear(e.getFullYear()+n)},function(e,n){return n.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}),h=n(function(e){e.setUTCMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getUTCSeconds()}),p=n(function(e){e.setUTCSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getUTCMinutes()}),M=n(function(e){e.setUTCMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getUTCHours()}),N=n(function(e){e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n)},function(e,n){return(n-e)/864e5},function(e){return e.getUTCDate()-1}),y=r(0),D=r(1),S=r(2),v=r(3),R=r(4),I=r(5),C=r(6),L=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(1)},function(e,n){e.setUTCMonth(e.getUTCMonth()+n)},function(e,n){return n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),U=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCMonth(0,1)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n)},function(e,n){return n.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}),P=o.range,Y=u.range,x=c.range,k=s.range,F=l.range,V=f.range,H=d.range,b=E.range,w=O.range,X=g.range,W=T.range,G=m.range,B=f.range,Q=A.range,Z=_.range,j=o,z=P,K=h.range,q=p.range,J=M.range,$=N.range,ee=y.range,ne=D.range,te=S.range,re=v.range,ie=R.range,ae=I.range,oe=C.range,ue=y.range,ce=L.range,se=U.range,le="0.1.1";e.version=le,e.milliseconds=P,e.seconds=Y,e.minutes=x,e.hours=k,e.days=F,e.sundays=V,e.mondays=H,e.tuesdays=b,e.wednesdays=w,e.thursdays=X,e.fridays=W,e.saturdays=G,e.weeks=B,e.months=Q,e.years=Z,e.utcMillisecond=j,e.utcMilliseconds=z,e.utcSeconds=K,e.utcMinutes=q,e.utcHours=J,e.utcDays=$,e.utcSundays=ee,e.utcMondays=ne,e.utcTuesdays=te,e.utcWednesdays=re,e.utcThursdays=ie,e.utcFridays=ae,e.utcSaturdays=oe,e.utcWeeks=ue,e.utcMonths=ce,e.utcYears=se,e.millisecond=o,e.second=u,e.minute=c,e.hour=s,e.day=l,e.sunday=f,e.monday=d,e.tuesday=E,e.wednesday=O,e.thursday=g,e.friday=T,e.saturday=m,e.week=f,e.month=A,e.year=_,e.utcSecond=h,e.utcMinute=p,e.utcHour=M,e.utcDay=N,e.utcSunday=y,e.utcMonday=D,e.utcTuesday=S,e.utcWednesday=v,e.utcThursday=R,e.utcFriday=I,e.utcSaturday=C,e.utcWeek=y,e.utcMonth=L,e.utcYear=U,e.interval=n})},{}],7:[function(e,n,t){function r(e){if(!e)throw Error("Missing binning options.");var n,t,r,u,c,s,l,f=e.maxbins||15,d=e.base||10,E=Math.log(d),O=e.div||[5,2],g=e.min,T=e.max,m=T-g;if(e.step)n=e.step;else if(e.steps)n=e.steps[Math.min(e.steps.length-1,i(e.steps,m/f,0,e.steps.length))];else{for(t=Math.ceil(Math.log(f)/E),r=e.minstep||0,n=Math.max(r,Math.pow(d,Math.round(Math.log(m)/E)-t));Math.ceil(m/n)>f;)n*=d;for(s=0;s<O.length;++s)c=n/O[s],c>=r&&f>=m/c&&(n=c)}return c=Math.log(n),u=c>=0?0:~~(-c/E)+1,l=Math.pow(d,-u-1),g=Math.min(g,Math.floor(g/n+l)*n),T=Math.ceil(T/n)*n,{start:g,stop:T,step:n,unit:{precision:u},value:a,index:o}}function i(e,n,t,r){for(;r>t;){var i=t+r>>>1;s.cmp(e[i],n)<0?t=i+1:r=i}return t}function a(e){return this.step*Math.floor(e/this.step+f)}function o(e){return Math.floor((e-this.start)/this.step+f)}function u(e){return this.unit.date(a.call(this,e))}function c(e){return o.call(this,this.unit.unit(e))}var s=e("../util"),l=e("../time"),f=1e-15;r.date=function(e){if(!e)throw Error("Missing date binning options.");var n=e.utc?l.utc:l,t=e.min,i=e.max,a=e.maxbins||20,o=e.minbins||4,s=+i-+t,f=e.unit?n[e.unit]:n.find(s,o,a),d=r({min:null!=f.min?f.min:f.unit(t),max:null!=f.max?f.max:f.unit(i),maxbins:a,minstep:f.minstep,steps:f.step});return d.unit=f,d.index=c,e.raw||(d.value=u),d},n.exports=r},{"../time":9,"../util":10}],8:[function(e,n,t){var r=e("./util"),i=n.exports;i.repeat=function(e,n){var t,r=Array(n);for(t=0;n>t;++t)r[t]=e;return r},i.zeros=function(e){return i.repeat(0,e)},i.range=function(e,n,t){if(arguments.length<3&&(t=1,arguments.length<2&&(n=e,e=0)),(n-e)/t==1/0)throw new Error("Infinite range");var r,i=[],a=-1;if(0>t)for(;(r=e+t*++a)>n;)i.push(r);else for(;(r=e+t*++a)<n;)i.push(r);return i},i.random={},i.random.uniform=function(e,n){void 0===n&&(n=void 0===e?1:e,e=0);var t=n-e,r=function(){return e+t*Math.random()};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(r){return r>=e&&n>=r?1/t:0},r.cdf=function(r){return e>r?0:r>n?1:(r-e)/t},r.icdf=function(n){return n>=0&&1>=n?e+n*t:NaN},r},i.random.integer=function(e,n){void 0===n&&(n=e,e=0);var t=n-e,r=function(){return e+Math.floor(t*Math.random())};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(r){return r===Math.floor(r)&&r>=e&&n>r?1/t:0},r.cdf=function(r){var i=Math.floor(r);return e>i?0:i>=n?1:(i-e+1)/t},r.icdf=function(n){return n>=0&&1>=n?e-1+Math.floor(n*t):NaN},r},i.random.normal=function(e,n){e=e||0,n=n||1;var t,r=function(){var r,i,a=0,o=0;if(void 0!==t)return a=t,t=void 0,a;do a=2*Math.random()-1,o=2*Math.random()-1,r=a*a+o*o;while(0===r||r>1);return i=Math.sqrt(-2*Math.log(r)/r),t=e+o*i*n,e+a*i*n};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(t){var r=Math.exp(Math.pow(t-e,2)/(-2*Math.pow(n,2)));return 1/(n*Math.sqrt(2*Math.PI))*r},r.cdf=function(t){var r,i=(t-e)/n,a=Math.abs(i);if(a>37)r=0;else{var o,u=Math.exp(-a*a/2);7.07106781186547>a?(o=.0352624965998911*a+.700383064443688,o=o*a+6.37396220353165,o=o*a+33.912866078383,o=o*a+112.079291497871,o=o*a+221.213596169931,o=o*a+220.206867912376,r=u*o,o=.0883883476483184*a+1.75566716318264,o=o*a+16.064177579207,o=o*a+86.7807322029461,o=o*a+296.564248779674,o=o*a+637.333633378831,o=o*a+793.826512519948,o=o*a+440.413735824752,r/=o):(o=a+.65,o=a+4/o,o=a+3/o,o=a+2/o,o=a+1/o,r=u/o/2.506628274631)}return i>0?1-r:r},r.icdf=function(t){if(0>=t||t>=1)return NaN;var r=2*t-1,i=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),a=2/(Math.PI*i)+Math.log(1-Math.pow(r,2))/2,o=Math.log(1-r*r)/i,u=(r>0?1:-1)*Math.sqrt(Math.sqrt(a*a-o)-a);return e+n*Math.SQRT2*u},r},i.random.bootstrap=function(e,n){var t=e.filter(r.isValid),a=t.length,o=n?i.random.normal(0,n):null,u=function(){return t[~~(Math.random()*a)]+(o?o():0)};return u.samples=function(e){return i.zeros(e).map(u)},u}},{"./util":10}],9:[function(e,n,t){function r(e){return s.setTime(+e),s}function i(e,n,t,r,i,a){var o={type:e,date:n,unit:t};return r?o.step=r:o.minstep=1,null!=i&&(o.min=i),null!=a&&(o.max=a),o}function a(e,n,t,r,a,o){return i(e,function(e){return n.offset(t,e)},function(e){return n.count(t,e)},r,a,o)}function o(e,n,t,r){var i,a,o,u=O[0];for(i=1,a=O.length;a>i;++i)if(u=O[i],n>u[0]){if(o=n/u[0],o>r)return e[O[i-1][1]];if(o>=t)return e[u[1]]}return e[O[a-1][1]]}function u(e){var n,t,r={};for(n=0,t=e.length;t>n;++n)r[e[n].type]=e[n];return r.find=function(n,t,r){return o(e,n,t,r)},r}var c=e("d3-time"),s=new Date,l=new Date(0,0,1).setFullYear(0),f=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),d=[a("second",c.second,l),a("minute",c.minute,l),a("hour",c.hour,l),a("day",c.day,l,[1,7]),a("month",c.month,l,[1,3,6]),a("year",c.year,l),i("seconds",function(e){return new Date(1970,0,1,0,0,e)},function(e){return r(e).getSeconds()},null,0,59),i("minutes",function(e){return new Date(1970,0,1,0,e)},function(e){return r(e).getMinutes()},null,0,59),i("hours",function(e){return new Date(1970,0,1,e)},function(e){return r(e).getHours()},null,0,23),i("weekdays",function(e){return new Date(1970,0,4+e)},function(e){return r(e).getDay()},[1],0,6),i("dates",function(e){return new Date(1970,0,e)},function(e){return r(e).getDate()},[1],1,31),i("months",function(e){return new Date(1970,e%12,1)},function(e){return r(e).getMonth()},[1],0,11)],E=[a("second",c.utcSecond,f),a("minute",c.utcMinute,f),a("hour",c.utcHour,f),a("day",c.utcDay,f,[1,7]),a("month",c.utcMonth,f,[1,3,6]),a("year",c.utcYear,f),i("seconds",function(e){return new Date(Date.UTC(1970,0,1,0,0,e))},function(e){return r(e).getUTCSeconds()},null,0,59),i("minutes",function(e){return new Date(Date.UTC(1970,0,1,0,e))},function(e){return r(e).getUTCMinutes()},null,0,59),i("hours",function(e){return new Date(Date.UTC(1970,0,1,e))},function(e){return r(e).getUTCHours()},null,0,23),i("weekdays",function(e){return new Date(Date.UTC(1970,0,4+e))},function(e){return r(e).getUTCDay()},[1],0,6),i("dates",function(e){return new Date(Date.UTC(1970,0,e))},function(e){return r(e).getUTCDate()},[1],1,31),i("months",function(e){return new Date(Date.UTC(1970,e%12,1))},function(e){return r(e).getUTCMonth()},[1],0,11)],O=[[31536e6,5],[7776e6,4],[2592e6,4],[12096e5,3],[6048e5,3],[1728e5,3],[864e5,3],[432e5,2],[216e5,2],[108e5,2],[36e5,2],[18e5,1],[9e5,1],[3e5,1],[6e4,1],[3e4,0],[15e3,0],[5e3,0],[1e3,0]];n.exports=u(d),n.exports.utc=u(E)},{"d3-time":6}],10:[function(e,n,t){(function(e){function t(e,n){var t,r="";for(t=0;e>t;++t)r+=n;return r}function r(e,n,t){var r=0,i=e.split(c);return e=t?(i=i.reverse()).filter(function(e){return r+=e.length,n>=r}).reverse():i.filter(function(e){return r+=e.length,n>=r}),e.length?e.join("").trim():i[0].slice(0,n)}var i=n.exports,a="__name__";i.namedfunc=function(e,n){return n[a]=e,n},i.name=function(e){return null==e?null:e[a]},i.identity=function(e){return e},i["true"]=i.namedfunc("true",function(){return!0}),i["false"]=i.namedfunc("false",function(){return!1}),i.duplicate=function(e){return JSON.parse(JSON.stringify(e))},i.equal=function(e,n){return JSON.stringify(e)===JSON.stringify(n)},i.extend=function(e){for(var n,t,r=1,i=arguments.length;i>r;++r){n=arguments[r];for(t in n)e[t]=n[t]}return e},i.length=function(e){return null!=e&&null!=e.length?e.length:null},i.keys=function(e){var n,t=[];for(n in e)t.push(n);return t},i.vals=function(e){var n,t=[];for(n in e)t.push(e[n]);return t},i.toMap=function(e,n){return(n=i.$(n))?e.reduce(function(e,t){return e[n(t)]=1,e},{}):e.reduce(function(e,n){return e[n]=1,e},{})},i.keystr=function(e){var n=e.length;if(!n)return"";for(var t=String(e[0]),r=1;n>r;++r)t+="|"+String(e[r]);return t};var o=Object.prototype.toString;i.isObject=function(e){return e===Object(e)},i.isFunction=function(e){return"[object Function]"===o.call(e)},i.isString=function(e){return"string"==typeof value||"[object String]"===o.call(e)},i.isArray=Array.isArray||function(e){return"[object Array]"===o.call(e)},i.isNumber=function(e){return"number"==typeof e||"[object Number]"===o.call(e)},i.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==o.call(e)},i.isDate=function(e){return"[object Date]"===o.call(e)},i.isValid=function(e){return null!=e&&e===e},i.isBuffer="function"==typeof e&&e.isBuffer||i["false"],i.number=function(e){return null==e||""===e?null:+e},i["boolean"]=function(e){return null==e||""===e?null:"false"===e?!1:!!e},i.date=function(e,n){var t=n?n:Date;return null==e||""===e?null:t.parse(e)},i.array=function(e){return null!=e?i.isArray(e)?e:[e]:[]},i.str=function(e){return i.isArray(e)?"["+e.map(i.str)+"]":i.isObject(e)||i.isString(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e};var u=/\[(.*?)\]|[^.\[]+/g;i.field=function(e){return String(e).match(u).map(function(e){return"["!==e[0]?e:"'"!==e[1]&&'"'!==e[1]?e.slice(1,-1):e.slice(2,-2).replace(/\\(["'])/g,"$1")})},i.accessor=function(e){return null==e||i.isFunction(e)?e:i.namedfunc(e,Function("x","return x["+i.field(e).map(i.str).join("][")+"];"))},i.$=i.accessor,i.mutator=function(e){var n;return i.isString(e)&&(n=i.field(e)).length>1?function(e,t){for(var r=0;r<n.length-1;++r)e=e[n[r]];e[n[r]]=t}:function(n,t){n[e]=t}},i.$func=function(e,n){return function(t){t=i.$(t)||i.identity;var r=e+(i.name(t)?"_"+i.name(t):"");return i.namedfunc(r,function(e){return n(t(e))})}},i.$valid=i.$func("valid",i.isValid),i.$length=i.$func("length",i.length),i.$in=function(e,n){e=i.$(e);var t=i.isArray(n)?i.toMap(n):n;return function(n){return!!t[e(n)]}},i.comparator=function(e){var n=[];return void 0===e&&(e=[]),e=i.array(e).map(function(e){var t=1;return"-"===e[0]?(t=-1,e=e.slice(1)):"+"===e[0]&&(t=1,e=e.slice(1)),n.push(t),i.accessor(e)}),function(t,r){var i,a,o,u,c;for(i=0,a=e.length;a>i;++i){if(o=e[i],u=o(t),c=o(r),c>u)return-1*n[i];if(u>c)return n[i]}return 0}},i.cmp=function(e,n){return n>e?-1:e>n?1:e>=n?0:null===e?-1:null===n?1:NaN},i.numcmp=function(e,n){return e-n},i.stablesort=function(e,n,t){var r=e.reduce(function(e,n,r){return e[t(n)]=r,e},{});return e.sort(function(e,i){var a=n(e),o=n(i);return o>a?-1:a>o?1:r[t(e)]-r[t(i)]}),e},i.pad=function(e,n,r,i){i=i||" ";var a=n-e.length;if(0>=a)return e;switch(r){case"left":return t(a,i)+e;case"middle":case"center":return t(Math.floor(a/2),i)+e+t(Math.ceil(a/2),i);default:return e+t(a,i)}},i.truncate=function(e,n,t,i,a){var o=e.length;if(n>=o)return e;a=void 0!==a?String(a):"…";var u=Math.max(0,n-a.length);switch(t){case"left":return a+(i?r(e,u,1):e.slice(o-u));case"middle":case"center":var c=Math.ceil(u/2),s=Math.floor(u/2);return(i?r(e,c):e.slice(0,c))+a+(i?r(e,s,1):e.slice(o-s));default:return(i?r(e,u):e.slice(0,u))+a}};var c=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/}).call(this,e("buffer").Buffer)},{buffer:1}],11:[function(e,n,t){!function(e){e[e.VALUES="values"]="VALUES",e[e.COUNT="count"]="COUNT",e[e.VALID="valid"]="VALID",e[e.MISSING="missing"]="MISSING",e[e.DISTINCT="distinct"]="DISTINCT",e[e.SUM="sum"]="SUM",e[e.MEAN="mean"]="MEAN",e[e.AVERAGE="average"]="AVERAGE",e[e.VARIANCE="variance"]="VARIANCE",e[e.VARIANCEP="variancep"]="VARIANCEP",e[e.STDEV="stdev"]="STDEV",e[e.STDEVP="stdevp"]="STDEVP",e[e.MEDIAN="median"]="MEDIAN",e[e.Q1="q1"]="Q1",e[e.Q3="q3"]="Q3",e[e.MODESKEW="modeskew"]="MODESKEW",e[e.MIN="min"]="MIN",e[e.MAX="max"]="MAX",e[e.ARGMIN="argmin"]="ARGMIN",e[e.ARGMAX="argmax"]="ARGMAX"}(t.AggregateOp||(t.AggregateOp={}));var r=t.AggregateOp;t.AGGREGATE_OPS=[r.VALUES,r.COUNT,r.VALID,r.MISSING,r.DISTINCT,r.SUM,r.MEAN,r.AVERAGE,r.VARIANCE,r.VARIANCEP,r.STDEV,r.STDEVP,r.MEDIAN,r.Q1,r.Q3,r.MODESKEW,r.MIN,r.MAX,r.ARGMIN,r.ARGMAX],t.SHARED_DOMAIN_OPS=[r.MEAN,r.AVERAGE,r.STDEV,r.STDEVP,r.MEDIAN,r.Q1,r.Q3,r.MIN,r.MAX]},{}],12:[function(e,n,t){function r(e,n){return!!i(e)[n]}function i(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.DETAIL:case t.ORDER:case t.ROW:case t.COLUMN:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case t.SIZE:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,text:!0};case t.SHAPE:return{point:!0};case t.TEXT:return{text:!0};case t.PATH:return{line:!0}}return{}}function a(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.LABEL:return{measure:!0,dimension:!0};case t.ROW:case t.COLUMN:case t.SHAPE:case t.DETAIL:return{measure:!1,dimension:!0};case t.SIZE:case t.TEXT:return{measure:!0,dimension:!1};case t.PATH:return{measure:!1,dimension:!0}}throw new Error("Invalid encoding channel"+e)}function o(e){return!u.contains([t.DETAIL,t.PATH,t.TEXT,t.LABEL,t.ORDER],e)}var u=e("./util");!function(e){e[e.X="x"]="X",e[e.Y="y"]="Y",e[e.ROW="row"]="ROW",e[e.COLUMN="column"]="COLUMN",e[e.SHAPE="shape"]="SHAPE",e[e.SIZE="size"]="SIZE",e[e.COLOR="color"]="COLOR",e[e.TEXT="text"]="TEXT",e[e.DETAIL="detail"]="DETAIL",e[e.LABEL="label"]="LABEL",e[e.PATH="path"]="PATH",e[e.ORDER="order"]="ORDER"}(t.Channel||(t.Channel={}));var c=t.Channel;t.X=c.X,t.Y=c.Y,t.ROW=c.ROW,t.COLUMN=c.COLUMN,t.SHAPE=c.SHAPE,t.SIZE=c.SIZE,t.COLOR=c.COLOR,t.TEXT=c.TEXT,t.DETAIL=c.DETAIL,t.LABEL=c.LABEL,t.PATH=c.PATH,t.ORDER=c.ORDER,t.CHANNELS=[t.X,t.Y,t.ROW,t.COLUMN,t.SIZE,t.SHAPE,t.COLOR,t.PATH,t.ORDER,t.TEXT,t.DETAIL,t.LABEL],t.supportMark=r,t.getSupportedMark=i,t.getSupportedRole=a,t.hasScale=o},{"./util":21}],13:[function(e,n,t){function r(e){var n=0;return e.color&&n++,e.size&&n++,e.shape&&n++,n}function i(e){return f.CHANNELS.filter(function(n){return a(e,n)})}function a(e,n){var t=e&&e[n];return t&&(void 0!==t.field||d.isArray(t)&&t.length>0)}function o(e){return d.any(f.CHANNELS,function(n){return a(e,n)&&e[n].aggregate?!0:!1})}function u(e){var n=[];return f.CHANNELS.forEach(function(t){a(e,t)&&(d.isArray(e[t])?e[t].forEach(function(e){n.push(e)}):n.push(e[t]))}),n}function c(e,n,t){var r=0;f.CHANNELS.forEach(function(i){a(e,i)&&(d.isArray(e[i])?e[i].forEach(function(e){n.call(t,e,i,r++)}):n.call(t,e[i],i,r++))})}function s(e,n,t){var r=[];return f.CHANNELS.forEach(function(i){a(e,i)&&(d.isArray(e[i])?e[i].forEach(function(a){r.push(n.call(t,a,i,e))}):r.push(n.call(t,e[i],i,e)))}),r}function l(e,n,t,r){var i=t;return f.CHANNELS.forEach(function(t){a(e,t)&&(d.isArray(e[t])?e[t].forEach(function(a){i=n.call(r,i,a,t,e)}):i=n.call(r,i,e[t],t,e))}),i}var f=e("./channel"),d=e("./util");t.countRetinal=r,t.channels=i,t.has=a,t.isAggregate=o,t.fieldDefs=u,t.forEach=c,t.map=s,t.reduce=l},{"./channel":12,"./util":21}],14:[function(e,n,t){function r(e,n){void 0===n&&(n={});var t=(n.datum?"datum.":"")+(n.prefn||""),r=n.suffix||"",i=e.field;return c(e)?t+"count"+r:n.fn?t+n.fn+"_"+i+r:!n.nofn&&e.bin?t+"bin_"+i+(n.binSuffix||r||"_start"):n.nofn||n.noAggregate||!e.aggregate?!n.nofn&&e.timeUnit?t+e.timeUnit+"_"+i+r:t+i:t+e.aggregate+"_"+i+r}function i(e){return O.contains([E.NOMINAL,E.ORDINAL],e.type)||!!e.bin||e.type===E.TEMPORAL&&!!e.timeUnit}function a(e){return e&&e.field&&i(e)}function o(e){return e&&e.field&&!i(e)}function u(){return{field:"*",aggregate:f.AggregateOp.COUNT,type:E.QUANTITATIVE,displayName:t.COUNT_DISPLAYNAME}}function c(e){return e.aggregate===f.AggregateOp.COUNT}function s(e,n,t){void 0===t&&(t={});var r=n[e.field],i=e.type;if(e.bin){var a=e.bin,o="boolean"==typeof a?void 0:a.maxbins;void 0===o&&(o=10);var u=O.getbins(r,o);return(u.stop-u.start)/u.step}if(i===E.TEMPORAL){var c=e.timeUnit;switch(c){case d.TimeUnit.SECONDS:return 60;case d.TimeUnit.MINUTES:return 60;case d.TimeUnit.HOURS:return 24;case d.TimeUnit.DAY:return 7;case d.TimeUnit.DATE:return 31;case d.TimeUnit.MONTH:return 12;case d.TimeUnit.YEAR:var s=n["year_"+e.field];return s?s.distinct-(r.missing>0&&t[i]?1:0):null}}return e.aggregate?1:r.distinct-(r.missing>0&&t[i]?1:0)}function l(e){if(c(e))return t.COUNT_DISPLAYNAME;var n=e.aggregate||e.timeUnit||e.bin&&"bin";return n?n.toString().toUpperCase()+"("+e.field+")":e.field}var f=e("./aggregate"),d=e("./timeunit"),E=e("./type"),O=e("./util");t.aggregate={type:"string","enum":f.AGGREGATE_OPS,supportedEnums:{quantitative:f.AGGREGATE_OPS,ordinal:["median","min","max"],nominal:[],temporal:["mean","median","min","max"],"":["count"]},supportedTypes:O.toMap([E.QUANTITATIVE,E.NOMINAL,E.ORDINAL,E.TEMPORAL,""])},t.field=r,t.isDimension=a,t.isMeasure=o,t.COUNT_DISPLAYNAME="Number of Records",t.count=u,t.isCount=c,t.cardinality=s,t.title=l},{"./aggregate":11,"./timeunit":19,"./type":20,"./util":21}],15:[function(e,n,t){!function(e){e[e.AREA="area"]="AREA",e[e.BAR="bar"]="BAR",e[e.LINE="line"]="LINE",e[e.POINT="point"]="POINT",e[e.TEXT="text"]="TEXT",e[e.TICK="tick"]="TICK",e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE"}(t.Mark||(t.Mark={}));var r=t.Mark;t.AREA=r.AREA,t.BAR=r.BAR,t.LINE=r.LINE,t.POINT=r.POINT,t.TEXT=r.TEXT,t.TICK=r.TICK,t.CIRCLE=r.CIRCLE,t.SQUARE=r.SQUARE},{}],16:[function(e,n,t){!function(e){e[e.LINEAR="linear"]="LINEAR",e[e.LOG="log"]="LOG",e[e.POW="pow"]="POW",e[e.SQRT="sqrt"]="SQRT",e[e.QUANTILE="quantile"]="QUANTILE",e[e.QUANTIZE="quantize"]="QUANTIZE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TIME="time"]="TIME",e[e.UTC="utc"]="UTC"}(t.ScaleType||(t.ScaleType={}));t.ScaleType;!function(e){e[e.SECOND="second"]="SECOND",e[e.MINUTE="minute"]="MINUTE",e[e.HOUR="hour"]="HOUR",e[e.DAY="day"]="DAY",e[e.WEEK="week"]="WEEK",e[e.MONTH="month"]="MONTH",e[e.YEAR="year"]="YEAR"}(t.NiceTime||(t.NiceTime={}));t.NiceTime;t.defaultScaleConfig={round:!0,textBandWidth:90,bandSize:21,padding:1,includeRawDomain:!1,nominalColorRange:"category10",sequentialColorRange:["#AFC6A3","#09622A"],shapeRange:"shapes",fontSizeRange:[8,40]},t.defaultFacetScaleConfig={round:!0,padding:16}},{}],17:[function(e,n,t){function r(e){return"mark"+t.ASSIGN+e.mark+t.DELIM+a(e.encoding)}function i(e,n,r){var i=e.split(t.DELIM),a=i.shift().split(t.ASSIGN)[1].trim(),u=o(i.join(t.DELIM)),c={mark:O.Mark[a],encoding:u};return void 0!==n&&(c.data=n),void 0!==r&&(c.config=r),c}function a(e){return E.map(e,function(e,n){return n+t.ASSIGN+u(e)}).join(t.DELIM)}function o(e){return e.split(t.DELIM).reduce(function(e,n){var r=n.split(t.ASSIGN),i=r[0].trim(),a=r[1];return e[i]=s(a),e},{})}function u(e){return(e.aggregate?e.aggregate+t.FUNC:"")+(e.timeUnit?e.timeUnit+t.FUNC:"")+(e.bin?"bin"+t.FUNC:"")+(e.field||"")+t.TYPE+d.SHORT_TYPE[e.type]}function c(e,n){return void 0===n&&(n=t.DELIM),e.map(u).join(n)}function s(e){for(var n=e.split(t.TYPE),r={field:n[0].trim(),type:d.TYPE_FROM_SHORT_TYPE[n[1].trim()]},i=0;i<l.AGGREGATE_OPS.length;i++){var a=l.AGGREGATE_OPS[i];if(0===r.field.indexOf(a+"_")){r.field=r.field.substr(a.toString().length+1),a===l.AggregateOp.COUNT&&0===r.field.length&&(r.field="*"),r.aggregate=a;break}}for(var i=0;i<f.TIMEUNITS.length;i++){var o=f.TIMEUNITS[i];if(r.field&&0===r.field.indexOf(o+"_")){r.field=r.field.substr(r.field.length+1),r.timeUnit=o;break}}return r.field&&0===r.field.indexOf("bin_")&&(r.field=r.field.substr(4),r.bin=!0),r}var l=e("./aggregate"),f=e("./timeunit"),d=e("./type"),E=e("./encoding"),O=e("./mark");t.DELIM="|",t.ASSIGN="=",t.TYPE=",",t.FUNC="_",t.shorten=r,t.parse=i,t.shortenEncoding=a,t.parseEncoding=o,t.shortenFieldDef=u,t.shortenFieldDefs=c,t.parseFieldDef=s},{"./aggregate":11,"./encoding":13,"./mark":15,"./timeunit":19,"./type":20}],18:[function(e,n,t){function r(e){return s.isAggregate(e.encoding)}function i(e){return s.fieldDefs(e.encoding)}function a(e){return e}function o(e){return(s.has(e.encoding,c.COLOR)||s.has(e.encoding,c.SHAPE))&&(e.mark===l.BAR||e.mark===l.AREA)&&(!e.config||!e.config.mark.stacked!=!1)&&s.isAggregate(e.encoding)}function u(e){var n=e.encoding,t=f.duplicate(e.encoding);return t.x=n.y,t.y=n.x,t.row=n.column,t.column=n.row,e.encoding=t,e}var c=e("./channel"),s=e("./encoding"),l=e("./mark"),f=e("./util");t.alwaysNoOcclusion=r,t.fieldDefs=i,t.getCleanSpec=a,t.isStack=o,t.transpose=u},{"./channel":12,"./encoding":13,"./mark":15,"./util":21}],19:[function(e,n,t){!function(e){e[e.YEAR="year"]="YEAR",e[e.MONTH="month"]="MONTH",e[e.DAY="day"]="DAY",e[e.DATE="date"]="DATE",e[e.HOURS="hours"]="HOURS",e[e.MINUTES="minutes"]="MINUTES",e[e.SECONDS="seconds"]="SECONDS",e[e.MILLISECONDS="milliseconds"]="MILLISECONDS",e[e.YEARMONTH="yearmonth"]="YEARMONTH",e[e.YEARMONTHDAY="yearmonthday"]="YEARMONTHDAY",e[e.YEARMONTHDATE="yearmonthdate"]="YEARMONTHDATE",e[e.YEARDAY="yearday"]="YEARDAY",e[e.YEARDATE="yeardate"]="YEARDATE",e[e.YEARMONTHDAYHOURS="yearmonthdayhours"]="YEARMONTHDAYHOURS",e[e.YEARMONTHDAYHOURSMINUTES="yearmonthdayhoursminutes"]="YEARMONTHDAYHOURSMINUTES",e[e.YEARMONTHDAYHOURSMINUTESSECONDS="yearmonthdayhoursminutesseconds"]="YEARMONTHDAYHOURSMINUTESSECONDS",e[e.HOURSMINUTES="hoursminutes"]="HOURSMINUTES",e[e.HOURSMINUTESSECONDS="hoursminutesseconds"]="HOURSMINUTESSECONDS",e[e.MINUTESSECONDS="minutesseconds"]="MINUTESSECONDS",e[e.SECONDSMILLISECONDS="secondsmilliseconds"]="SECONDSMILLISECONDS"}(t.TimeUnit||(t.TimeUnit={}));var r=t.TimeUnit;t.TIMEUNITS=[r.YEAR,r.MONTH,r.DAY,r.DATE,r.HOURS,r.MINUTES,r.SECONDS,r.MILLISECONDS,r.YEARMONTH,r.YEARMONTHDAY,r.YEARMONTHDATE,r.YEARDAY,r.YEARDATE,r.YEARMONTHDAYHOURS,r.YEARMONTHDAYHOURSMINUTES,r.YEARMONTHDAYHOURSMINUTESSECONDS,r.HOURSMINUTES,r.HOURSMINUTESSECONDS,r.MINUTESSECONDS,r.SECONDSMILLISECONDS]},{}],20:[function(e,n,t){function r(e){var n=e;return t.TYPE_FROM_SHORT_TYPE[n.toUpperCase()]||n.toLowerCase()}!function(e){e[e.QUANTITATIVE="quantitative"]="QUANTITATIVE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TEMPORAL="temporal"]="TEMPORAL",e[e.NOMINAL="nominal"]="NOMINAL"}(t.Type||(t.Type={}));var i=t.Type;t.QUANTITATIVE=i.QUANTITATIVE,t.ORDINAL=i.ORDINAL,t.TEMPORAL=i.TEMPORAL,t.NOMINAL=i.NOMINAL,t.SHORT_TYPE={quantitative:"Q",temporal:"T",nominal:"N",ordinal:"O"},t.TYPE_FROM_SHORT_TYPE={Q:t.QUANTITATIVE,T:t.TEMPORAL,O:t.ORDINAL,N:t.NOMINAL},t.getFullName=r},{}],21:[function(e,n,t){function r(e,n){return e.indexOf(n)>-1}function i(e,n){return e.filter(function(e){return!r(n,e)})}function a(e,n,t){if(e.forEach)e.forEach.call(t,n);else for(var r in e)e.hasOwnProperty(r)&&n.call(t,e[r],r,e)}function o(e,n,t,r){if(e.reduce)return e.reduce.call(r,n,t);for(var i in e)e.hasOwnProperty(i)&&(t=n.call(r,t,e[i],i,e));return t}function u(e,n,t){if(e.map)return e.map.call(t,n);var r=[];for(var i in e)e.hasOwnProperty(i)&&r.push(n.call(t,e[i],i,e));return r}function c(e,n){for(var t=0,r=0;r<e.length;r++)if(n(e[r],r,t++))return!0;return!1}function s(e,n){for(var t=0,r=0;r<e.length;r++)if(!n(e[r],r,t++))return!1;return!0}function l(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];
for(var r=0;r<n.length;r++)e=f(e,n[r]);return e}function f(e,n){if("object"!=typeof n||null===n)return e;for(var t in n)n.hasOwnProperty(t)&&void 0!==n[t]&&("object"!=typeof n[t]||null===n[t]?e[t]=n[t]:"object"!=typeof e[t]||null===e[t]?e[t]=l(n[t].constructor===Array?[]:{},n[t]):l(e[t],n[t]));return e}function d(e,n){return T({min:e.min,max:e.max,maxbins:n})}function E(e){console.error("[VL Error]",e)}var O=e("datalib/src/util");t.keys=O.keys,t.extend=O.extend,t.duplicate=O.duplicate,t.isArray=O.isArray,t.vals=O.vals,t.truncate=O.truncate,t.toMap=O.toMap,t.isObject=O.isObject;var g=e("datalib/src/generate");t.range=g.range,t.contains=r,t.without=i,t.forEach=a,t.reduce=o,t.map=u,t.any=c,t.all=s,t.mergeDeep=l;var T=e("datalib/src/bins/bins");t.getbins=d,t.error=E},{"datalib/src/bins/bins":7,"datalib/src/generate":8,"datalib/src/util":10}],22:[function(e,n,t){function r(e,n,r){void 0===n&&(n=t.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===r&&(r=t.DEFAULT_SUPPORTED_CHANNEL_TYPE);var i=e.mark,o=e.encoding,u=n[i],c=r[i];for(var s in u)if(!(u[s]in o))return'Missing encoding channel "'+u[s]+'" for mark "'+i+'"';for(var l in o)if(!c[l])return'Encoding channel "'+l+'" is not supported by mark type "'+i+'"';return i!==a.BAR||o.x||o.y?null:"Missing both x and y for bar"}var i=e("./util"),a=e("./mark");t.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],area:["x","y"]},t.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:i.toMap(["row","column","x","y","size","color","detail"]),line:i.toMap(["row","column","x","y","color","detail"]),area:i.toMap(["row","column","x","y","color","detail"]),tick:i.toMap(["row","column","x","y","color","detail"]),circle:i.toMap(["row","column","x","y","color","size","detail"]),square:i.toMap(["row","column","x","y","color","size","detail"]),point:i.toMap(["row","column","x","y","color","size","detail","shape"]),text:i.toMap(["row","column","size","color","text"])},t.getEncodingMappingError=r},{"./mark":15,"./util":21}],23:[function(e,n,t){function r(e,n){var r=t.distance.table(e),c=a.hcluster(e,function(e,n){var t=i.shorten(e),a=i.shorten(n);return r[t][a]},"average",o.CLUSTER_THRESHOLD),s=c.map(function(e){return u.traverse(e,[])}).map(function(e){return e.sort(function(e,n){return n._info.score-e._info.score})}).filter(function(e){return e.length>0}).sort(function(e,n){return n[0]._info.score-e[0]._info.score});return s.dist=r,s}var i=e("vega-lite/src/shorthand"),a=e("clusterfck"),o=e("./clusterconsts"),u=e("../util"),c=e("./distance");t.distance=c,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},{"../util":39,"./clusterconsts":24,"./distance":25,clusterfck:2,"vega-lite/src/shorthand":17}],24:[function(e,n,t){"use strict";function r(e,n){var t=n[0],r=n[1],i=n[2];return e[t]=e[t]||{},e[r]=e[r]||{},e[t][r]=e[r][t]=i,e}t.SWAPPABLE=.05,t.DIST_MISSING=1,t.CLUSTER_THRESHOLD=1,t.DIST_BY_CHANNEL=[["x","y",t.SWAPPABLE],["row","column",t.SWAPPABLE],["color","shape",t.SWAPPABLE],["color","detail",t.SWAPPABLE],["detail","shape",t.SWAPPABLE],["size","color",t.SWAPPABLE]].reduce(r,{})},{}],25:[function(e,n,t){function r(e){var n,t,r=e.length,o=e.map(function(e){return a(e)}),c=e.map(u.shorten),s={};for(n=0;r>n;n++)s[c[n]]={};for(n=0;r>n;n++)for(t=n+1;r>t;t++){var l=c[t],f=c[n];s[l][f]=s[f][l]=i(o[n],o[t])}return s}function i(e,n){var t=s.union(s.keys(e.channelByField),s.keys(n.channelByField)),r=0;t.forEach(function(t){var i=e.channelByField[t],a=n.channelByField[t];i&&a?i.channel!==a.channel&&(r+=(c.DIST_BY_CHANNEL[i.channel]||{})[a.channel]||1):r+=c.DIST_MISSING});var i=o.isStack(e),a=o.isStack(n);return(i||a)&&(i&&a?(e.encoding.color&&n.encoding.color&&e.encoding.color.field!==n.encoding.color.field||e.encoding.detail&&n.encoding.detail&&e.encoding.detail.field!==n.encoding.detail.field)&&(r+=1):r+=1),r}function a(e){var n={},t=e.encoding;return s.keys(t).forEach(function(e){var r=s.duplicate(t[e]);r.channel=e,n[r.field||""]=r,delete r.field}),{mark:e.mark,channelByField:n,encoding:e.encoding}}var o=e("vega-lite/src/spec"),u=e("vega-lite/src/shorthand"),c=e("./clusterconsts"),s=e("../util");t.table=r,t.get=i,t.extendSpecWithChannelByColumnName=a},{"../util":39,"./clusterconsts":24,"vega-lite/src/shorthand":17,"vega-lite/src/spec":18}],26:[function(e,n,t){var r=e("vega-lite/src/channel"),i=e("vega-lite/src/mark");t.DEFAULT_PROJECTION_OPT={omitDotPlot:!1,maxCardinalityForAutoAddOrdinal:50,alwaysAddHistogram:!0,maxAdditionalVariables:1},function(e){e[e.BOTH="both"]="BOTH",e[e.AGGREGATED="aggregated"]="AGGREGATED",e[e.DISAGGREGATED="disaggregated"]="DISAGGREGATED"}(t.TableType||(t.TableType={}));var a=t.TableType;!function(e){e[e.AUTO="auto"]="AUTO",e[e.BIN="bin"]="BIN",e[e.CAST="cast"]="CAST",e[e.NONE="none"]="NONE"}(t.QuantitativeDimensionType||(t.QuantitativeDimensionType={}));var o=t.QuantitativeDimensionType;t.DEFAULT_AGGREGATION_OPTIONS={tableTypes:a.BOTH,genDimQ:o.AUTO,minCardinalityForBin:20,omitDotPlot:!1,omitMeasureOnly:!1,omitDimensionOnly:!0,addCountForDimensionOnly:!0,aggrList:[void 0,"mean"],timeUnitList:["year"],consistentAutoQ:!0},t.DEFAULT_SCALE_OPTION={rescaleQuantitative:[void 0]},t.DEFAULT_SPEC_OPTION={markList:[i.Mark.POINT,i.Mark.BAR,i.Mark.LINE,i.Mark.AREA,i.Mark.TEXT,i.Mark.TICK],channelList:[r.X,r.Y,r.ROW,r.COLUMN,r.SIZE,r.COLOR,r.TEXT,r.DETAIL],alwaysGenerateTableAsHeatmap:!0,maxGoodCardinalityForFacets:5,maxCardinalityForFacets:20,maxGoodCardinalityForColor:7,maxCardinalityForColor:20,maxCardinalityForShape:6,omitDotPlot:!1,omitDotPlotWithExtraEncoding:!0,omitDotPlotWithFacet:!0,omitDotPlotWithOnlyCount:!1,omitMultipleNonPositionalChannels:!0,omitNonTextAggrWithAllDimsOnFacets:!0,omitRawWithXYBothDimension:!0,omitShapeWithBin:!0,omitShapeWithTimeDimension:!0,omitSizeOnBar:!0,omitLengthForLogScale:!0,omitStackedAverage:!0,omitTranspose:!0}},{"vega-lite/src/channel":12,"vega-lite/src/mark":15}],27:[function(e,n,t){var r=e("./consts"),i=e("./cluster/cluster"),a=e("./gen/gen"),o=e("./rank/rank"),u=e("./util"),c=e("./trans/trans");t.consts=r,t.cluster=i["default"],t.gen=a,t.rank=o,t.util=u,t.trans=c,t.auto="-, sum",t.version="0.7.0"},{"./cluster/cluster":23,"./consts":26,"./gen/gen":30,"./rank/rank":34,"./trans/trans":38,"./util":39}],28:[function(e,n,t){"use strict";function r(e,n,t,r){function f(n){n=c.duplicate(n),n.key=n.map(function(e){return a.shortenFieldDef(e)}).join(a.DELIM),e.push(n)}function d(){if(r.omitMeasureOnly||r.omitDimensionOnly){var e=!1,n=!1,t=!1;if(_.forEach(function(r){i.isDimension(r)?n=!0:(e=!0,r.aggregate||(t=!0))}),!n&&!t&&r.omitMeasureOnly)return;if(!e&&(r.addCountForDimensionOnly&&(_.push(i.count()),f(_),_.pop()),r.omitDimensionOnly))return}r.omitDotPlot&&1===_.length||f(_)}function E(e,n,t,r){var i=n===!0||null===n,a=n===!1||null===n;r?i&&(_[e].aggregate=r,A(e+1,!0,t),delete _[e].aggregate):a&&A(e+1,!1,t)}function O(e,n,t){_[e].bin=!0,A(e+1,n,t),delete _[e].bin}function g(e,a,f){var d=n[e],g=a===!0||null===a;if(_[e]={field:d.field,type:d.type},d.aggregate===u.AggregateOp.COUNT)g&&(_[e].aggregate=d.aggregate,A(e+1,!0,f));else if(d._aggregate)E(e,a,f,d._aggregate);else if(d._raw)E(e,a,f,void 0);else if(d._bin)O(e,a,f);else if(r.aggrList.forEach(function(n){r.consistentAutoQ&&f!==l&&f!==n||E(e,a,n,n)}),(!r.consistentAutoQ||c.isin(f,[l,"bin","cast","autocast"]))&&!h){var T=i.cardinality(d,t)>r.minCardinalityForBin,m=r.genDimQ===s.QuantitativeDimensionType.AUTO,p=r.genDimQ===s.QuantitativeDimensionType.BIN||m&&T,M=r.genDimQ===s.QuantitativeDimensionType.CAST||m&&!T;p&&c.isin(f,[l,"bin","autocast"])&&O(e,a,m?"autocast":"bin"),M&&c.isin(f,[l,"cast","autocast"])&&(_[e].type=o.Type.ORDINAL,A(e+1,a,m?"autocast":"cast"),_[e].type=o.Type.QUANTITATIVE)}}function T(e,n,t,r){_[e].timeUnit=r,A(e+1,n,t),delete _[e].timeUnit}function m(e,t,i){var a=n[e];_[e]={field:a.field,type:a.type},a._timeUnit?T(e,t,i,a._timeUnit):r.timeUnitList.forEach(function(n){void 0===n?t||A(e+1,!1,i):T(e,t,i,n)})}function A(e,t,r){if(e===n.length)return void d();var i=n[e];switch(i.type){case o.Type.QUANTITATIVE:g(e,t,r);break;case o.Type.TEMPORAL:m(e,t,r);break;case o.Type.ORDINAL:case o.Type.NOMINAL:default:_[e]=i,A(e+1,t,r)}}void 0===r&&(r={}),r=c.extend({},s.DEFAULT_AGGREGATION_OPTIONS,r);var _=new Array(n.length),h=c.any(n,function(e){return e.type===o.Type.NOMINAL||e.type===o.Type.ORDINAL}),p=r.tableTypes===s.TableType.AGGREGATED?!0:r.tableTypes===s.TableType.DISAGGREGATED?!1:null;return A(0,p,l),e}var i=e("vega-lite/src/fielddef"),a=e("vega-lite/src/shorthand"),o=e("vega-lite/src/type"),u=e("vega-lite/src/aggregate"),c=e("../util"),s=e("../consts"),l="*";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},{"../consts":26,"../util":39,"vega-lite/src/aggregate":11,"vega-lite/src/fielddef":14,"vega-lite/src/shorthand":17,"vega-lite/src/type":20}],29:[function(e,n,t){function r(e,n,t,r){function a(c){if(c===n.length)return void(d.encoding(u,t,r)&&e.push(o.duplicate(u)));var s=n[c];for(var f in r.channelList){var E=r.channelList[f],O=i.isDimension(s),g=l.getSupportedRole(E);E in u||!(O&&g.dimension||!O&&g.measure)||!d.channel[E](u,s,t,r)||(u[E]=s,a(c+1),delete u[E])}}void 0===r&&(r=c.DEFAULT_SPEC_OPTION);var u={};return a(0),e}var i=e("vega-lite/src/fielddef"),a=e("vega-lite/src/encoding"),o=e("../util"),u=e("./marks"),c=e("../consts"),s=e("vega-lite/src/aggregate"),l=e("vega-lite/src/channel"),f=e("vega-lite/src/type");Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var d;!function(e){function n(e,n,t){if(t.omitDotPlot)return!1;if(t.omitTranspose&&e.y)return!1;if(t.omitDotPlotWithFacet&&(e.row||e.column))return!1;if(t.omitDotPlotWithExtraEncoding&&o.keys(e).length>1)return!1;if(t.omitDotPlotWithOnlyCount){if(e.x&&e.x.aggregate===s.AggregateOp.COUNT&&!e.y)return!1;if(e.y&&e.y.aggregate===s.AggregateOp.COUNT&&!e.x)return!1}return!0}function t(e){var n=!1,t=!1;for(var r in e){var a=r,o=e[a];if(o.aggregate&&(n=!0),i.isDimension(o)&&a!==l.ROW&&a!==l.COLUMN&&(t=!0),n&&t)break}return n&&!t}function r(e,n,r){if((e.row||e.column)&&r.omitNonTextAggrWithAllDimsOnFacets&&t(e))return!1;var o=i.isDimension(e.x),u=i.isDimension(e.y);if(r.omitRawWithXYBothDimension&&o&&u&&!a.isAggregate(e))return!1;if(r.omitTranspose){if(o!==u)return e.y.type!==f.Type.NOMINAL&&e.y.type!==f.Type.ORDINAL||!i.isMeasure(e.x)?!u&&o&&e.x.type!==f.Type.NOMINAL&&e.x.type!==f.Type.ORDINAL?!0:!1:!0;if(e.y.type===f.Type.TEMPORAL||e.x.type===f.Type.TEMPORAL){if(e.y.type===f.Type.TEMPORAL&&e.x.type!==f.Type.TEMPORAL)return!1}else if(e.x.field>e.y.field)return!1}return!0}function c(e,t,i){if(e.text)return u.rule.text(e,t,i);var a=!!e.x,o=!!e.y;return a!==o?n(e,t,i):a&&o?r(e,t,i):!1}var d;!function(e){function n(e,n,t,r){return a(e,n,t,r)?i.isMeasure(n)||i.cardinality(n,t)<=r.maxCardinalityForColor:!1}function t(e,n,t,r){return a(e,n,t,r)?r.omitShapeWithBin&&n.bin&&n.type===f.Type.QUANTITATIVE?!1:r.omitShapeWithTimeDimension&&n.timeUnit&&n.type===f.Type.TEMPORAL?!1:i.cardinality(n,t)<=r.maxCardinalityForShape:!1}function r(){return!0}function a(e,n,t,r){return r.omitMultipleNonPositionalChannels&&(e.color||e.size||e.shape)?!1:!0}e.x=r,e.y=r,e.text=r,e.detail=r,e.size=a,e.row=r,e.column=r,e.color=n,e.shape=t}(d=e.channel||(e.channel={})),e.encoding=c}(d||(d={}))},{"../consts":26,"../util":39,"./marks":31,"vega-lite/src/aggregate":11,"vega-lite/src/channel":12,"vega-lite/src/encoding":13,"vega-lite/src/fielddef":14,"vega-lite/src/type":20}],30:[function(e,n,t){"use strict";var r=e("./aggregates"),i=e("./projections"),a=e("./projections"),o=e("./specs"),u=e("./encodings"),c=e("./marks");t.aggregates=r["default"],t.projections=i["default"],t.projections.key=a.key,t.specs=o["default"],t.encodings=u["default"],t.marks=c["default"]},{"./aggregates":28,"./encodings":29,"./marks":31,"./projections":32,"./specs":33}],31:[function(e,n,t){function r(e,n,t){return t.markList.filter(function(r){var i=null===o.getEncodingMappingError({mark:r,encoding:e});return i&&f[r](e,n,t)})}var i=e("vega-lite/src/encoding"),a=e("vega-lite/src/fielddef"),o=e("vega-lite/src/validate"),u=e("vega-lite/src/type"),c=e("vega-lite/src/scale"),s=e("vega-lite/src/aggregate"),l=e("../util");Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var f;!function(e){function n(e,n,t){return a.cardinality(e,n)<=t.maxCardinalityForFacets}function t(e,t,r){return e.row&&!n(e.row,t,r)?!1:e.column&&!n(e.column,t,r)?!1:!0}function r(e,n,r){if(!t(e,n,r))return!1;if(e.x&&e.y){var i=a.isDimension(e.x),o=a.isDimension(e.y);if(i&&o){if(e.shape)return!1;if(e.color&&a.isDimension(e.color))return!1}}else{if(r.omitDotPlot)return!1;if(r.omitTranspose&&e.y)return!1;if(r.omitDotPlotWithExtraEncoding&&l.keys(e).length>1)return!1}return!0}function o(e,n,t){if(e.x||e.y){if(i.isAggregate(e))return!1;var r=a.isDimension(e.x),o=a.isDimension(e.y);return!r&&(!e.y||o)||!o&&(!e.x||r)}return!1}function f(e,n,r){if(!t(e,n,r))return!1;if(!e.x&&!e.y)return!1;if(r.omitSizeOnBar&&void 0!==e.size)return!1;if(r.omitLengthForLogScale){if(e.x&&e.x.scale&&e.x.scale.type===c.ScaleType.LOG)return!1;if(e.y&&e.y.scale&&e.y.scale.type===c.ScaleType.LOG)return!1}var i=(!e.x||void 0===e.x.aggregate)!=(!e.y||void 0===e.y.aggregate);if(i){var o=(!e.x||a.isDimension(e.x))!==(!e.y||a.isDimension(e.y));if(o){var u;return u=e.x?e.x.aggregate:e.y.aggregate,!(r.omitStackedAverage&&u===s.AggregateOp.MEAN&&e.color)}}return!1}function d(e,n,r){return t(e,n,r)?e.x.type===u.Type.TEMPORAL&&!!e.x.timeUnit&&e.y.type===u.Type.QUANTITATIVE&&!!e.y.aggregate:!1}function E(e,n,r){if(!t(e,n,r))return!1;if(!d(e,n,r))return!1;if(r.omitLengthForLogScale){if(e.x&&e.x.scale&&e.x.scale.type===c.ScaleType.LOG)return!1;if(e.y&&e.y.scale&&e.y.scale.type===c.ScaleType.LOG)return!1}return!(r.omitStackedAverage&&e.y.aggregate===s.AggregateOp.MEAN&&e.color)}function O(e,n,t){return(e.row||e.column)&&e.text&&e.text.aggregate&&!e.x&&!e.y&&!e.size&&(!t.alwaysGenerateTableAsHeatmap||!e.color)}e.point=r,e.tick=o,e.bar=f,e.line=d,e.area=E,e.text=O}(f=t.rule||(t.rule={}))},{"../util":39,"vega-lite/src/aggregate":11,"vega-lite/src/encoding":13,"vega-lite/src/fielddef":14,"vega-lite/src/scale":16,"vega-lite/src/type":20,"vega-lite/src/validate":22}],32:[function(e,n,t){function r(e,n,t){void 0===t&&(t={}),t=u.extend({},c.DEFAULT_PROJECTION_OPT,t);var r=[],f=[],d=[],E=!1,O=!1,g={};e.forEach(function(e,i){if(g[e.field]=i,e.selected)r.push(e),l(e)||e.type===s.TEMPORAL?E=!0:O=!0;else if(e.selected!==!1&&!o.isCount(e)){if(o.isDimension(e)&&!t.maxCardinalityForAutoAddOrdinal&&o.cardinality(e,n,15)>t.maxCardinalityForAutoAddOrdinal)return;f.push(e)}}),f.sort(i(E,O,g));var T=u.chooseKorLess(f,t.maxAdditionalVariables);return T.forEach(function(e){var n=r.concat(e);if(n.length>0){if(t.omitDotPlot&&1===n.length)return;d.push(n)}}),d.forEach(function(e){e.key=a(e)}),d}function i(e,n,t){return function(n,r){return n.type!==r.type?e?f[r.type]-f[n.type]:f[n.type]-f[r.type]:t[n.field]-t[r.field]}}function a(e){return e.map(function(e){return o.isCount(e)?"count":e.field}).join(",")}var o=e("vega-lite/src/fielddef"),u=e("../util"),c=e("../consts"),s=e("vega-lite/src/type"),l=o.isDimension;Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var f={nominal:0,ordinal:0,temporal:2,quantitative:3};t.key=a},{"../consts":26,"../util":39,"vega-lite/src/fielddef":14,"vega-lite/src/type":20}],33:[function(e,n,t){"use strict";function r(e,n,t,r,a){void 0===r&&(r={}),r=u.extend({},c.DEFAULT_SPEC_OPTION,r);var o=s["default"]([],n,t,r);return a?o.reduce(function(e,n){var a=d.shortenEncoding(n);return e[a]=i([],n,t,r),e},{}):o.reduce(function(e,n){return i(e,n,t,r)},e)}function i(e,n,t,r){return l["default"](n,t,r).forEach(function(i){var o=u.duplicate({encoding:n,config:r.config});o.mark=i,o.data=r.data,o=a(o,t,r);var c=f.encoding(o,t,r);o._info=c,e.push(o)}),e}function a(e,n,t){"text"===e.mark&&t.alwaysGenerateTableAsHeatmap&&(e.encoding.color=e.encoding.text);var r=e.encoding;return["x","y"].forEach(function(e){var t=r[e];if(t&&o.isMeasure(t)&&!o.isCount(t)){var i=n[t.field];i&&i.stdev/i.mean<.01&&(t.scale={zero:!1})}}),e}var o=e("vega-lite/src/fielddef"),u=e("../util"),c=e("../consts"),s=e("./encodings"),l=e("./marks"),f=e("../rank/rank"),d=e("vega-lite/src/shorthand");Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},{"../consts":26,"../rank/rank":34,"../util":39,"./encodings":29,"./marks":31,"vega-lite/src/fielddef":14,"vega-lite/src/shorthand":17}],34:[function(e,n,t){var r=e("./rankEncodings");t.encoding=r["default"]},{"./rankEncodings":35}],35:[function(e,n,t){"use strict";function r(e,n,r,o){var l=[],O=c.keys(e.encoding),g=e.mark,T=e.encoding,m=i.reduce(e.encoding,function(e,n,t){var r=s.shortenFieldDef(n),i=e[r]=e[r]||[];return i.push({channel:t,fieldDef:n}),e},{});return c.forEach(m,function(i){var u=i.map(function(e){return e.channel+s.ASSIGN+s.shortenFieldDef(e.fieldDef)+" "+(o&&o[e.fieldDef.field]?"[x]":"[ ]")}),c=i.map(function(i){var u=a.isDimension(i.fieldDef)?t.dimensionScore:t.measureScore,c=u(i.fieldDef,i.channel,e.mark,n,r);return!o||o[i.fieldDef.field]?c:Math.pow(c,.125)});l.push({reason:u.join(" | "),score:Math.max.apply(null,c)})}),"text"===g||T.x&&T.y&&u(T.x)!==u(T.y)&&l.push({reason:"OxQ plot",score:.8}),O.length>1&&g!==f.Mark.TEXT&&(T.x&&T.y||T.geo||T.text||l.push({reason:"unused position",score:d})),l.push({reason:"mark="+g,score:E[g]}),{score:l.reduce(function(e,n){return e*n.score},1),features:l}}var i=e("vega-lite/src/encoding"),a=e("vega-lite/src/fielddef"),o=e("vega-lite/src/channel"),u=a.isDimension,c=e("../util"),s=e("vega-lite/src/shorthand"),l=e("vega-lite/src/type"),f=e("vega-lite/src/mark"),d=.5,E={line:.99,area:.98,bar:.97,tick:.96,point:.95,circle:.94,square:.94,text:.8},O={},g={},T=.1,m=.01;O.minor=.01,O.pos=1,O.Y_T=.8,O.facet_text=1,O.facet_good=.675,O.facet_ok=.55,O.facet_bad=.4,O.color_good=.7,O.color_ok=.65,O.color_bad=.3,O.color_stack=.6,O.shape=.6,O.detail=.5,O.bad=T,O.terrible=m,g.pos=1,g.size=.6,g.color=.5,g.text=.4,g.bad=T,g.terrible=m,t.dimensionScore=function(e,n,t,r,i){var u=a.cardinality(e,r);switch(n){case o.X:return e.type===l.Type.NOMINAL||e.type===l.Type.ORDINAL?O.pos-O.minor:O.pos;case o.Y:return e.type===l.Type.NOMINAL||e.type===l.Type.ORDINAL?O.pos-O.minor:e.type===l.Type.TEMPORAL?O.Y_T:O.pos-O.minor;case o.COLUMN:return"text"===t?O.facet_text:u<=i.maxGoodCardinalityForFacets?O.facet_good:u<=i.maxCardinalityForFacets?O.facet_ok:O.facet_bad;case o.ROW:return"text"===t?O.facet_text:(u<=i.maxGoodCardinalityForFacets?O.facet_good:u<=i.maxCardinalityForFacets?O.facet_ok:O.facet_bad)-O.minor;case o.COLOR:var c=e.bin&&e.type===l.Type.QUANTITATIVE||e.timeUnit&&e.type===l.Type.TEMPORAL,s=t===f.Mark.BAR||t===f.Mark.AREA;return c?O.color_bad:s?O.color_stack:u<=i.maxGoodCardinalityForColor?O.color_good:u<=i.maxCardinalityForColor?O.color_ok:O.color_bad;case o.SHAPE:return u<=i.maxCardinalityForShape?O.shape:m;case o.DETAIL:return O.detail}return m},t.dimensionScore.consts=O,t.measureScore=function(e,n,t,r,i){switch(n){case o.X:return g.pos;case o.Y:return g.pos;case o.SIZE:return t===f.Mark.BAR||t===f.Mark.TEXT||t===f.Mark.LINE?T:g.size;case o.COLOR:return g.color;case o.TEXT:return g.text}return T},t.measureScore.consts=g,Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},{"../util":39,"vega-lite/src/channel":12,"vega-lite/src/encoding":13,"vega-lite/src/fielddef":14,"vega-lite/src/mark":15,"vega-lite/src/shorthand":17,"vega-lite/src/type":20}],36:[function(e,n,t){t.DEFAULT_MARKTYPE_TRANSITIONS={AREA_BAR:{name:"AREA_BAR",cost:1},AREA_LINE:{name:"AREA_LINE",cost:1},AREA_POINT:{name:"AREA_POINT",cost:1},AREA_TEXT:{name:"AREA_TEXT",cost:1},AREA_TICK:{name:"AREA_TICK",cost:1},BAR_LINE:{name:"BAR_LINE",cost:1},BAR_POINT:{name:"BAR_POINT",cost:1},BAR_TEXT:{name:"BAR_TEXT",cost:1},BAR_TICK:{name:"BAR_TICK",cost:1},LINE_POINT:{name:"LINE_POINT",cost:1},LINE_TEXT:{name:"LINE_TEXT",cost:1},LINE_TICK:{name:"LINE_TICK",cost:1},POINT_TEXT:{name:"POINT_TEXT",cost:1},POINT_TICK:{name:"POINT_TICK",cost:1},TEXT_TICK:{name:"TEXT_TICK",cost:1}},t.DEFAULT_MARKTYPE_TRANSITION_LIST=["AREA_BAR","AREA_LINE","AREA_POINT","AREA_TEXT","AREA_TICK","BAR_LINE","BAR_POINT","BAR_TEXT","BAR_TICK","LINE_POINT","LINE_TEXT","LINE_TICK","POINT_TEXT","POINT_TICK","TEXT_TICK"],t.DEFAULT_TRANSFORM_TRANSITIONS={SCALE:{name:"SCALE",cost:1},SORT:{name:"SORT",cost:1},BIN:{name:"BIN",cost:1},AGGREGATE:{name:"AGGREGATE",cost:1},FILTER:{name:"FILTER",cost:1},SETTYPE:{name:"SETTYPE",cost:1}},t.DEFAULT_TRANSFORM_TRANSITION_LIST=["SCALE","SORT","BIN","AGGREGATE","FILTER","SETTYPE"],t.CHANNELS_WITH_TRANSITION_ORDER=["x","y","color","shape","size","row","column","text"],t.DEFAULT_ENCODING_TRANSITIONS={ADD_X:{name:"ADD_X",cost:1},ADD_Y:{name:"ADD_Y",cost:1},ADD_COLOR:{name:"ADD_COLOR",cost:1},ADD_SHAPE:{name:"ADD_SHAPE",cost:1},ADD_SIZE:{name:"ADD_SIZE",cost:1},ADD_ROW:{name:"ADD_ROW",cost:1},ADD_COLUMN:{name:"ADD_COLUMN",cost:1},ADD_X_COUNT:{name:"ADD_X_COUNT",cost:1},ADD_Y_COUNT:{name:"ADD_Y_COUNT",cost:1},ADD_COLOR_COUNT:{name:"ADD_COLOR_COUNT",cost:1},ADD_SHAPE_COUNT:{name:"ADD_SHAPE_COUNT",cost:1},ADD_SIZE_COUNT:{name:"ADD_SIZE_COUNT",cost:1},ADD_ROW_COUNT:{name:"ADD_ROW_COUNT",cost:1},ADD_COLUMN_COUNT:{name:"ADD_COLUMN_COUNT",cost:1},REMOVE_X_COUNT:{name:"REMOVE_X_COUNT",cost:1},REMOVE_Y_COUNT:{name:"REMOVE_Y_COUNT",cost:1},REMOVE_COLOR_COUNT:{name:"REMOVE_COLOR_COUNT",cost:1},REMOVE_SHAPE_COUNT:{name:"REMOVE_SHAPE_COUNT",cost:1},REMOVE_SIZE_COUNT:{name:"REMOVE_SIZE_COUNT",cost:1},REMOVE_ROW_COUNT:{name:"REMOVE_ROW_COUNT",cost:1},REMOVE_COLUMN_COUNT:{name:"REMOVE_COLUMN_COUNT",cost:1},REMOVE_X:{name:"REMOVE_X",cost:1},REMOVE_Y:{name:"REMOVE_Y",cost:1},REMOVE_COLOR:{name:"REMOVE_COLOR",cost:1},REMOVE_SHAPE:{name:"REMOVE_SHAPE",cost:1},REMOVE_SIZE:{name:"REMOVE_SIZE",cost:1},REMOVE_ROW:{name:"REMOVE_ROW",cost:1},REMOVE_COLUMN:{name:"REMOVE_COLUMN",cost:1},MODIFY_X:{name:"MODIFY_X",cost:1},MODIFY_Y:{name:"MODIFY_Y",cost:1},MODIFY_COLOR:{name:"MODIFY_COLOR",cost:1},MODIFY_SHAPE:{name:"MODIFY_SHAPE",cost:1},MODIFY_SIZE:{name:"MODIFY_SIZE",cost:1},MODIFY_ROW:{name:"MODIFY_ROW",cost:1},MODIFY_COLUMN:{name:"MODIFY_COLUMN",cost:1},MODIFY_X_ADD_COUNT:{name:"MODIFY_X_ADD_COUNT",cost:1},MODIFY_Y_ADD_COUNT:{name:"MODIFY_Y_ADD_COUNT",cost:1},MODIFY_COLOR_ADD_COUNT:{name:"MODIFY_COLOR_ADD_COUNT",cost:1},MODIFY_SHAPE_ADD_COUNT:{name:"MODIFY_SHAPE_ADD_COUNT",cost:1},MODIFY_SIZE_ADD_COUNT:{name:"MODIFY_SIZE_ADD_COUNT",cost:1},MODIFY_ROW_ADD_COUNT:{name:"MODIFY_ROW_ADD_COUNT",cost:1},MODIFY_COLUMN_ADD_COUNT:{name:"MODIFY_COLUMN_ADD_COUNT",cost:1},MODIFY_X_REMOVE_COUNT:{name:"MODIFY_X_REMOVE_COUNT",cost:1},MODIFY_Y_REMOVE_COUNT:{name:"MODIFY_Y_REMOVE_COUNT",cost:1},MODIFY_COLOR_REMOVE_COUNT:{name:"MODIFY_COLOR_REMOVE_COUNT",cost:1},MODIFY_SHAPE_REMOVE_COUNT:{name:"MODIFY_SHAPE_REMOVE_COUNT",cost:1},MODIFY_SIZE_REMOVE_COUNT:{name:"MODIFY_SIZE_REMOVE_COUNT",cost:1},MODIFY_ROW_REMOVE_COUNT:{name:"MODIFY_ROW_REMOVE_COUNT",cost:1},MODIFY_COLUMN_REMOVE_COUNT:{name:"MODIFY_COLUMN_REMOVE_COUNT",cost:1},MOVE_X_COLUMN:{name:"MOVE_X_COLUMN",cost:1},MOVE_X_ROW:{name:"MOVE_X_ROW",cost:1},MOVE_X_SIZE:{name:"MOVE_X_SIZE",cost:1},MOVE_X_SHAPE:{name:"MOVE_X_SHAPE",cost:1},MOVE_X_COLOR:{name:"MOVE_X_COLOR",cost:1},MOVE_X_Y:{name:"MOVE_X_Y",cost:1},MOVE_Y_COLUMN:{name:"MOVE_Y_COLUMN",cost:1},MOVE_Y_ROW:{name:"MOVE_Y_ROW",cost:1},MOVE_Y_SIZE:{name:"MOVE_Y_SIZE",cost:1},MOVE_Y_SHAPE:{name:"MOVE_Y_SHAPE",cost:1},MOVE_Y_COLOR:{name:"MOVE_Y_COLOR",cost:1},MOVE_Y_X:{name:"MOVE_Y_X",cost:1},MOVE_COLOR_COLUMN:{name:"MOVE_COLOR_COLUMN",cost:1},MOVE_COLOR_ROW:{name:"MOVE_COLOR_ROW",cost:1},MOVE_COLOR_SIZE:{name:"MOVE_COLOR_SIZE",cost:1},MOVE_COLOR_SHAPE:{name:"MOVE_COLOR_SHAPE",cost:1},MOVE_COLOR_Y:{name:"MOVE_COLOR_Y",cost:1},MOVE_COLOR_X:{name:"MOVE_COLOR_X",cost:1},MOVE_SHAPE_COLUMN:{name:"MOVE_SHAPE_COLUMN",cost:1},MOVE_SHAPE_ROW:{name:"MOVE_SHAPE_ROW",cost:1},MOVE_SHAPE_SIZE:{name:"MOVE_SHAPE_SIZE",cost:1},MOVE_SHAPE_COLOR:{name:"MOVE_SHAPE_COLOR",cost:1},MOVE_SHAPE_Y:{name:"MOVE_SHAPE_Y",cost:1},MOVE_SHAPE_X:{name:"MOVE_SHAPE_X",cost:1},MOVE_SIZE_COLUMN:{name:"MOVE_SIZE_COLUMN",cost:1},MOVE_SIZE_ROW:{name:"MOVE_SIZE_ROW",cost:1},MOVE_SIZE_SHAPE:{name:"MOVE_SIZE_SHAPE",cost:1},MOVE_SIZE_COLOR:{name:"MOVE_SIZE_COLOR",cost:1},MOVE_SIZE_Y:{name:"MOVE_SIZE_Y",cost:1},MOVE_SIZE_X:{name:"MOVE_SIZE_X",cost:1},MOVE_ROW_COLUMN:{name:"MOVE_ROW_COLUMN",cost:1},MOVE_ROW_SIZE:{name:"MOVE_ROW_SIZE",cost:1},MOVE_ROW_SHAPE:{name:"MOVE_ROW_SHAPE",cost:1},MOVE_ROW_COLOR:{name:"MOVE_ROW_COLOR",cost:1},MOVE_ROW_Y:{name:"MOVE_ROW_Y",cost:1},MOVE_ROW_X:{name:"MOVE_ROW_X",cost:1},MOVE_COLUMN_ROW:{name:"MOVE_COLUMN_ROW",cost:1},MOVE_COLUMN_SIZE:{name:"MOVE_COLUMN_SIZE",cost:1},MOVE_COLUMN_SHAPE:{name:"MOVE_COLUMN_SHAPE",cost:1},MOVE_COLUMN_COLOR:{name:"MOVE_COLUMN_COLOR",cost:1},MOVE_COLUMN_Y:{name:"MOVE_COLUMN_Y",cost:1},MOVE_COLUMN_X:{name:"MOVE_COLUMN_X",cost:1},SWAP_X_Y:{name:"SWAP_X_Y",cost:1},SWAP_ROW_COLUMN:{name:"SWAP_ROW_COLUMN",cost:1}},t.TRANSITIONS={marktypeTransitions:t.DEFAULT_MARKTYPE_TRANSITIONS,transformTransitions:t.DEFAULT_TRANSFORM_TRANSITIONS,encodingTransitions:t.DEFAULT_ENCODING_TRANSITIONS}},{}],37:[function(e,n,t){function r(e,n,t,r){var c=[],s=r||u.DEFAULT_ENCODING_TRANSITIONS,l=o.keys(e.encoding),f=t;l.forEach(function(r){var a=o.duplicate(e),u="REMOVE_"+r.toUpperCase();u+="*"===e.encoding[r].field?"_COUNT":"";var d=s[u],E=o.duplicate(n);E.push(a.encoding[r]);var O=o.duplicate(t);O.push(r),delete a.encoding[r],i(a)&&(a.transition=d,a.additionalFields=E,a.additionalChannels=O,c.push(a)),n.forEach(function(l,f){a=o.duplicate(e),u="MODIFY_"+r.toUpperCase(),"*"===e.encoding[r].field&&"*"!==l.field?u+="_REMOVE_COUNT":"*"!==e.encoding[r].field&&"*"===l.field&&(u+="_ADD_COUNT"),d=s[u],E=o.duplicate(n),E.splice(f,1),E.push(a.encoding[r]),O=o.duplicate(t),a.encoding[r]=l,i(a)&&(a.transition=d,a.additionalFields=E,a.additionalChannels=O,c.push(a))}),l.forEach(function(u){if(!(u===r||["x","y"].indexOf(r)<0||["x","y"].indexOf(u)<0)){a=o.duplicate(e),d=s.SWAP_X_Y,E=o.duplicate(n),O=o.duplicate(t);var l=o.duplicate(a.encoding[r]);a.encoding[r]=a.encoding[u],a.encoding[u]=l,i(a)&&(a.transition=d,a.additionalFields=E,a.additionalChannels=O,c.push(a))}}),f.forEach(function(u,l){a=o.duplicate(e);var f=(r+"_"+u).toUpperCase();d=s["MOVE_"+f],E=o.duplicate(n),O=o.duplicate(t),O.splice(l,1),O.push(r),a.encoding[u]=o.duplicate(a.encoding[r]),delete a.encoding[r],i(a)&&(a.transition=d,a.additionalFields=E,a.additionalChannels=O,c.push(a))})}),f.forEach(function(r,a){n.forEach(function(u,l){var f=o.duplicate(e),d="ADD_"+r.toUpperCase();d+="*"===u.field?"_COUNT":"";var E=s[d],O=o.duplicate(n),g=o.duplicate(t);O.splice(l,1),f.encoding[r]=u,g.splice(a,1),i(f)&&(f.transition=E,f.additionalFields=O,f.additionalChannels=g,c.push(f))})});for(var d=0;d<c.length;d+=1)for(var E=d+1;E<c.length;E+=1)a(c[d].encoding,c[E].encoding)&&(c.splice(E,1),E-=1);return c}function i(e){return!0}function a(e,n){var t=o.keys(e),r=o.keys(n);if(t.length!==r.length)return!1;for(var i=o.union(t,r),a=0;a<i.length;a+=1){var u=i[a];if(!e[u]||!n[u])return!1;if(e[u].field!==n[u].field)return!1}return!0}var o=e("../util"),u=e("./def");t.neighbors=r,t.sameEncoding=a},{"../util":39,"./def":36}],38:[function(e,n,t){"use strict";function r(e,n,t){var r=i(e,n,t),a=0;return a=r.marktype.reduce(function(e,n){return e+=n.cost},a),a=r.transform.reduce(function(e,n){return e+=n.cost},a),a=r.encoding.reduce(function(e,n){return e+=n.cost},a)}function i(e,n,t,r){var i=t?t.marktypeTransitions:E.DEFAULT_MARKTYPE_TRANSITIONS,u=t?t.transformTransitions:E.DEFAULT_TRANSFORM_TRANSITIONS,c=t?t.encodingTransitions:E.DEFAULT_ENCODING_TRANSITIONS,s={marktype:a(e,n,i),transform:o(e,n,u,r),encoding:l(e,n,c)},f=0;return f=s.marktype.reduce(function(e,n){return e+=n.cost},f),f=s.transform.reduce(function(e,n){return e+=n.cost},f),f=s.encoding.reduce(function(e,n){return e+=n.cost},f),s.cost=f,s}function a(e,n,t){var r=[],i=t||E.DEFAULT_MARKTYPE_TRANSITIONS;if(e.mark===n.mark)return r;var a=[e.mark.toUpperCase(),n.mark.toUpperCase()].sort().join("_");return r.push(d.duplicate(i[a])),r}function o(e,n,t,r){var i,a,o=t||o,l=[];return o.FILTER&&(i=c(e,n,o))&&l.push(i),f.CHANNELS.forEach(function(t){["SCALE","SORT","AGGREGATE","BIN","SETTYPE"].map(function(c){"SETTYPE"===c&&o[c]?i=s(e,n,t,o):o[c]&&(i=u(e,n,t,c,o,r)),i&&(a=d.find(l,function(e){return e.name},i),a>=0?l[a].details.push(i.detail):(l.push(i),l[l.length-1].details=[],l[l.length-1].details.push(i.detail),delete l[l.length-1].detail))})}),l}function u(e,n,t,r,i,a){var o,u,c,s=!1,l=!1;return e.encoding[t]&&e.encoding[t][r.toLowerCase()]&&(s=!0,u=e.encoding[t][r.toLowerCase()]),n.encoding[t]&&n.encoding[t][r.toLowerCase()]&&(l=!0,c=n.encoding[t][r.toLowerCase()]),a&&a.omitIncludeRawDomain&&"SCALE"===r&&(u&&u.includeRawDomain&&(delete u.includeRawDomain,0===Object.keys(u).length&&JSON.stringify(u)===JSON.stringify({})&&(s=!1)),c&&c.includeRawDomain&&(delete c.includeRawDomain,0===Object.keys(c).length&&JSON.stringify(c)===JSON.stringify({})&&(l=!1))),s&&l&&!d.rawEqual(u,c)?(o=d.duplicate(i[r]),o.detail={type:"modified",channel:t},o):s&&!l?(o=d.duplicate(i[r]),o.detail={type:"removed",channel:t},o):!s&&l?(o=d.duplicate(i[r]),o.detail={type:"added",channel:t},o):void 0}function c(e,n,t){var r,i=!1,a=!1;return e.transform&&e.transform.filter&&(i=!0),n.transform&&n.transform.filter&&(a=!0),i&&a&&!d.rawEqual(e.transform.filter,n.transform.filter)?(r=d.duplicate(t.FILTER),r.detail={type:"modified"},r):i&&!a?(r=d.duplicate(t.FILTER),r.detail={type:"removed"},r):!i&&a?(r=d.duplicate(t.FILTER),r.detail={type:"added"},r):void 0}function s(e,n,t,r){var i;return e.encoding[t]&&n.encoding[t]&&n.encoding[t].field===e.encoding[t].field&&n.encoding[t].type!==e.encoding[t].type?(i=d.duplicate(r.SETTYPE),i.detail={type:e.encoding[t].type+"_"+n.encoding[t].type,channel:t},i):void 0}function l(e,n,t){function r(e){var n=1/0,t=-1;return e.forEach(function(e,r){e.distance<n&&(n=e.distance,t=r)}),e.splice(t,1)[0]}if(O.sameEncoding(e.encoding,n.encoding))return[];var i,a=d.keys(e.encoding),o=a.map(function(n){return e.encoding[n]}),u=d.keys(n.encoding),c=u.map(function(e){return n.encoding[e]}),s=d.arrayDiff(c,o,function(e){return e.field+"_"+e.type}),l=d.arrayDiff(u,a),f=O.neighbors(e,s,l,t).map(function(n){return n.distance=n.transition.cost,n.prev=[e],n});e.distance=0,e.prev=[];for(var E=[e];f.length>0&&(i=r(f),!O.sameEncoding(i.encoding,n.encoding));){var g=O.neighbors(i,i.additionalFields,i.additionalChannels,t);g.forEach(function(e){for(var n,t=0;t<E.length;t+=1)if(O.sameEncoding(E[t].encoding,e.encoding))return;for(var t=0;t<f.length;t+=1)if(O.sameEncoding(f[t].encoding,e.encoding)){n=f[t];break}n?n.distance>i.distance+e.transition.cost&&(n.distance=i.distance+e.transition.cost,n.prev=i.prev.concat([i])):(e.distance=i.distance+e.transition.cost,e.prev=i.prev.concat([i]),f.push(e))}),E.push(i)}if(!O.sameEncoding(i.encoding,n.encoding)&&0===f.length)return[{name:"UNREACHABLE",cost:999}];var T=i.prev.map(function(e){return e.transition}).filter(function(e){return e});return T.push(i.transition),T}var f=e("vega-lite/src/channel"),d=e("../util"),E=e("./def"),O=e("./neighbor");t.transitionCost=r,t.transitionSet=i,t.marktypeTransitionSet=a,t.transformTransitionSet=o,t.transformBasic=u,t.transformFilter=c,t.transformSettype=s,t.encodingTransitionSet=l},{"../util":39,"./def":36,"./neighbor":37,"vega-lite/src/channel":12}],39:[function(e,n,t){function r(e,n){return-1!==n.indexOf(e)}function i(e,n){return JSON.stringify(e,null,n)}function a(e){var n,t=[];for(n in e)t.push(n);return t}function o(e){return JSON.parse(JSON.stringify(e))}function u(e,n,t){if(e.forEach)e.forEach.call(t,n);else for(var r in e)n.call(t,e[r],r,e)}function c(e,n){var t,r=0;for(t in e)if(n(e[t],t,r++))return!0;return!1}function s(e,n,t,r){return 0===t?e.map(n):e.map(function(e){var i=s(e,n,t-1);return r?i.filter(f):i})}function l(e,n,t,r){return 0===t?e.reduce(n,[]):e.map(function(e){var i=l(e,n,t-1);return r?i.filter(f):i})}function f(e){return!t.isArray(e)||e.length>0}function d(e,n){return void 0!==e.value?n.push(e.value):(e.left&&d(e.left,n),
e.right&&d(e.right,n)),n}function E(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var i,a,o=1,u=arguments.length;u>o;++o){i=arguments[o];for(a in i)e[a]=i[a]}return e}function O(e,n){var t={};return e.forEach(function(e){t[e]=!0}),n.forEach(function(e){t[e]=!0}),a(t)}function g(e){for(var n=[[]],t=0;t<e.length;t++)for(var r=0,i=n.length;i>r;r++)n.push(n[r].concat(e[t]));return n}function T(e,n){for(var t=[[]],r=0;r<e.length;r++)for(var i=0,a=t.length;a>i;i++){var o=t[i].concat(e[r]);o.length<=n&&t.push(o)}return t}function m(e,n){for(var t=[[]],r=[],i=0;i<e.length;i++)for(var a=0,o=t.length;o>a;a++){var u=t[a].concat(e[i]);u.length<n?t.push(u):u.length===n&&r.push(u)}return r}function A(e,n){for(var t=[],r=0;r<e.length;r++)for(var i=0;i<n.length;i++)t.push(e[r].concat(n[i]));return t}function _(e,n,t){for(var r=0;r<e.length;r+=1)if(n(t)===n(e[r]))return r;return-1}function h(e,n){return JSON.stringify(e)===JSON.stringify(n)}function p(e,n,t){return e.filter(function(e){return t?_(n,t,e)<0:_(n,JSON.stringify,e)<0})}t.isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},t.isin=r,t.json=i,t.keys=a,t.duplicate=o,t.forEach=u,t.any=c,t.nestedMap=s,t.nestedReduce=l,t.nonEmpty=f,t.traverse=d,t.extend=E,t.union=O;var M;!function(e){function n(e){return(e?a(e):[]).reduce(function(n,t){return n[t]=e[t],n},Object.create({}))}e.getOpt=n}(M=t.gen||(t.gen={})),t.powerset=g,t.chooseKorLess=T,t.chooseK=m,t.cross=A,t.find=_,t.rawEqual=h,t.arrayDiff=p},{}]},{},[27])(27)});
//# sourceMappingURL=compass.min.js.map
